<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Persona Feedback</title>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self' https: http:; img-src 'self' data: https: http:; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-eval'">
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
  <header class="pf-header">
    <div class="pf-title">Persona Feedback</div>
    <nav class="pf-tabs">
      <button id="tabReview" class="pf-tab pf-tab--active" type="button">Review</button>
      <button id="tabSettings" class="pf-tab" type="button">Settings</button>
    </nav>
    <button id="btnSettings" class="pf-gear" title="Settings">
      <span class="pf-gear-icon">⚙️</span><span class="pf-gear-text">Settings</span>
    </button>
  </header>
  <main id="view-review" class="pf-view active">
    <section class="pf-card">
      <div class="pf-field"><label for="reviewPersonaSetSelect">Personas</label><select id="reviewPersonaSetSelect"></select></div>
      <div id="reviewPersonaList" class="pf-persona-list"></div>
      <div class="pf-actions"><button id="btnRunReview" class="pf-primary">Run Review</button></div>
    </section>
    <section id="reviewOutput" class="pf-card">
      <h3>Results</h3>
      <div id="scoresContainer" class="pf-scores"></div>
      <div id="globalFeedbackContainer" class="pf-global"></div>
    </section>
  </main>
  <main id="view-settings" class="pf-view">
    <section class="pf-card">
      <h3>Model</h3>
      <div class="pf-grid">
        <div class="pf-field"><label for="providerSelect">Provider</label><select id="providerSelect"><option value="openrouter">OpenRouter</option><option value="ollama">Ollama (local)</option></select></div>
        <div class="pf-field" id="openrouterKeyRow"><label for="openrouterKey">OpenRouter API Key</label><input type="password" id="openrouterKey" placeholder="sk-or-v1-..." /></div>
        <div class="pf-field"><label for="modelInput">Model</label><input type="text" id="modelInput" placeholder="e.g. openrouter/auto or llama3.1:8b" /></div>
      </div>
    </section>
    <section class="pf-card">
      <h3>Persona Settings</h3>
      <div class="pf-field"><label for="settingsPersonaSetSelect">Persona Set</label><select id="settingsPersonaSetSelect"></select></div>
      <div id="personaEditorContainer"></div>
      <div class="pf-actions">
        <button id="btnSaveSettings" class="pf-primary">Save Settings</button>
        <button id="btnRestoreDefaults" class="pf-secondary">Restore Default Set</button>
        <button id="btnBackToReview" class="pf-link">← Back to Review</button>
      </div>
    </section>
  </main>
  <script src="taskpane.bundle.js"></script>
</body>
</html>
